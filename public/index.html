<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <title>Artesan√≠as Zen√∫ - Tienda Virtual</title>
    
</head>
<body>
    <!-- HEADER SUPERIOR -->
    <div class="header-top">
        <div class="header-container">
            <div class="logo">Artesan√≠as Zen√∫ <span>‚Ä¢ Tienda Virtual</span></div>
            <form class="search-bar" onsubmit="event.preventDefault(); alert('B√∫squeda: ' + this.query.value);">
                <input type="text" name="query" placeholder="Buscar productos, categor√≠as..." autocomplete="off">
                <button type="submit">üîç</button>
            </form>
            <div class="header-actions">
                <div id="user-info" class="user-info" style="display: none;">
                    <span class="welcome-text">¬°Hola, <span id="user-name">Usuario</span>!</span>
                    <button class="header-action logout-btn" id="btn-logout" title="Cerrar sesi√≥n">üö™</button>
                </div>
                <button class="header-action" id="btn-cuenta" title="Mi cuenta">üë§</button>
                <button class="header-action" id="btn-carrito" title="Carrito">
                    üõí<span class="badge" id="carrito-badge">0</span>
                </button>
            </div>
        </div>
    </div>
    <!-- MEN√ö DE CATEGOR√çAS -->
    <nav class="menu-categorias">
        <div class="categorias-container">
            <a href="" class="categoria-link active">Inicio</a>
            <a href="./canastos.html" class="categoria-link">Canastos</a>
            <a href="./mochilas.html" class="categoria-link">Mochilas</a>
            <a href="./sombreros.html" class="categoria-link">Sombreros</a>
            <a href="./pulseras.html" class="categoria-link">Pulseras</a>
            <a href="./ofertas.html" class="categoria-link">Ofertas</a>
        </div>
    </nav>
    <!-- BANNER PRINCIPAL -->
    <section class="banner">
        <div class="banner-text">
            <h2>¬°Bienvenido a Artesan√≠as Zen√∫!</h2>
            <p>Descubre la riqueza cultural y la belleza de nuestras artesan√≠as hechas a mano. Apoya el arte local y lleva a casa piezas √∫nicas llenas de historia.</p>
        </div>
        <div class="banner-img">üß∫</div>
    </section>
    <!-- BENEFICIOS -->
    <section class="beneficios">
        <div class="beneficio">
            <span class="beneficio-icono">üõ°Ô∏è</span>
            <span class="beneficio-texto">Compras seguras</span>
        </div>
        <div class="beneficio">
            <span class="beneficio-icono">üèÜ</span>
            <span class="beneficio-texto">Artesan√≠a premiada</span>
        </div>
        <div class="beneficio">
            <span class="beneficio-icono">üí≥</span>
            <span class="beneficio-texto">Paga en l√≠nea o en efectivo</span>
        </div>
        <div class="beneficio">
            <span class="beneficio-icono">üöö</span>
            <span class="beneficio-texto">Env√≠os a todo el pa√≠s</span>
        </div>
        <div class="beneficio">
            <span class="beneficio-icono">üéÅ</span>
            <span class="beneficio-texto">Promociones y descuentos</span>
        </div>
    </section>
    <!-- PRODUCTOS DESTACADOS -->
    <section class="productos-destacados" id="productos">
        <h3>Productos Destacados</h3>
        <div class="productos-grid">
            <div class="producto">
                <div class="producto-img">üß∫</div>
                <div class="producto-nombre">Canasto Zen√∫</div>
                <div class="producto-precio">$45.000</div>
                <button class="btn-comprar" onclick="agregarCarrito('Canasto Zen√∫')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <div class="producto-img">üéí</div>
                <div class="producto-nombre">Mochila Artesanal</div>
                <div class="producto-precio">$60.000</div>
                <button class="btn-comprar" onclick="agregarCarrito('Mochila Artesanal')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <div class="producto-img">ü™∂</div>
                <div class="producto-nombre">Sombrero Vueltiao</div>
                <div class="producto-precio">$80.000</div>
                <button class="btn-comprar" onclick="agregarCarrito('Sombrero Vueltiao')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <div class="producto-img">üßµ</div>
                <div class="producto-nombre">Pulsera Tejida</div>
                <div class="producto-precio">$15.000</div>
                <button class="btn-comprar" onclick="agregarCarrito('Pulsera Tejida')">Agregar al carrito</button>
            </div>
        </div>
    </section>
    <!-- MODAL LOGIN/REGISTRO/OLVIDO -->
    <div class="modal-bg" id="modal-bg">
        <div class="modal-content" id="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <!-- Aqu√≠ se insertar√° el formulario correspondiente -->
        </div>
    </div>

    <!-- CARRITO DESLIZABLE -->
    <div class="cart-overlay" id="cart-overlay"></div>
    <div class="cart-slide" id="cart-slide">
        <div class="cart-header">
            <h3>Mi Carrito</h3>
            <button class="cart-close" id="cart-close">&times;</button>
        </div>
        <div class="cart-content" id="cart-content">
            <!-- Los productos del carrito se cargar√°n din√°micamente -->
        </div>
        <div class="cart-footer" id="cart-footer">
            <div class="cart-summary" id="cart-summary" style="display: none;">
                <div class="cart-summary-row">
                    <span class="cart-summary-label">Subtotal:</span>
                    <span class="cart-summary-value" id="cart-subtotal">$0</span>
                </div>
                <div class="cart-summary-row">
                    <span class="cart-summary-label">Env√≠o:</span>
                    <span class="cart-summary-value" id="cart-shipping">Gratis</span>
                </div>
                <div class="cart-summary-row">
                    <span class="cart-summary-label">Total:</span>
                    <span class="cart-summary-value" id="cart-total-summary">$0</span>
                </div>
            </div>
            <div class="cart-total">
                <span class="cart-total-label">Total:</span>
                <span class="cart-total-amount" id="cart-total">$0</span>
            </div>
            <div class="cart-actions">
                <button class="btn-comprar" id="btn-comprar" disabled>Comprar Ahora</button>
                <button class="btn-continuar" id="btn-continuar">Continuar Comprando</button>
            </div>
        </div>
    </div>
    <!-- FOOTER -->
    <footer>
        <div class="footer-links">
            <a href="./Cont√°ctanos.html">Cont√°ctanos</a>
            <a href="./centro_de_ayudas.html">Centro de ayudas</a>
            <a href="#">Pol√≠tica de privacidad</a>
            <a href="#">T√©rminos y condiciones</a>
            <a href="./nosotros.html">Nosotros</a>

        </div>
        <div class="footer-social">
            <a href="#" title="Instagram">&#x1F4F7;</a>
            <a href="#" title="Facebook">&#x1F426;</a>
            <a href="#" title="WhatsApp">&#x1F4F2;</a>
        </div>
        &copy; 2024 Artesan√≠as Zen√∫. Todos los derechos reservados.
    </footer>
    <script src="./js/carrito.js"></script>
    <script>
    // MODAL LOGIN/REGISTRO/OLVIDO
    const loginForm = `
    <div class='conten_gen'>
      <div class='tex'>
        <h3>Hola de nuevo</h3>
        <p>Bienvenido</p>
        <input type='text' placeholder='Ingresar tu usuario' id='login-usuario'>
        <input type='password' placeholder='Ingresar tu contrase√±a' id='login-contrase√±a'>
        <button type='button' class='btn_ingresar' onclick='iniciarSesion()'>Ingresar</button>
        <p>
          <a href='#' id='modal-registro-link'>Registrarse</a> |
          <a href='#' id='modal-olvido-link'>¬øOlvidaste tu contrase√±a?</a>
        </p>
      </div>
      <div class='conten_izquierdo'>
        <h2>Artesanos tejiendo para crecer</h2>
        <p>√önete a nuestra comunidad y descubre la belleza de las artesan√≠as Zen√∫</p>
      </div>
    </div>`;
    
    const registroForm = `
    <div class='conten_gen'>
      <div class='tex'>
        <h3>Registro</h3>
        <p>¬°Crea tu cuenta!</p>
        <input type='text' placeholder='Ingresar tu usuario' id='reg-usuario'>
        <input type='password' placeholder='Ingresar tu contrase√±a' id='reg-contrase√±a'>
        <input type='email' placeholder='Ingresa tu email' id='reg-email'>
        <input type='number' placeholder='Ingresa tu n√∫mero' id='reg-telefono'>
        <button type='button' class='btn_ingresar' onclick='registrarUsuario()'>Registrarse</button>
        <p>
          <a href='#' id='modal-login-link'>¬øYa tienes cuenta? Inicia sesi√≥n</a>
        </p>
      </div>
      <div class='conten_izquierdo'>
        <h2>√önete a nuestra comunidad</h2>
        <p>Forma parte de una red que valora y preserva la cultura ancestral Zen√∫. Cada compra apoya directamente a nuestros artesanos.</p>
      </div>
    </div>`;
    
    const olvidoForm = `
    <div class='conten_gen'>
      <div class='tex'>
        <h3>Recuperar contrase√±a</h3>
        <p>Escribe tu correo para recuperar tu contrase√±a</p>
        <input type='email' placeholder='Ingresa tu email' id='olvido-email'>
        <button type='button' class='btn_ingresar' onclick='recuperarContrase√±a()'>Enviar</button>
        <p>
          <a href='#' id='modal-login-link-olvido'>¬øRecordaste tu contrase√±a? Inicia sesi√≥n</a>
        </p>
      </div>
      <div class='conten_izquierdo'>
        <h2>No te preocupes</h2>
        <p>Te ayudamos a recuperar el acceso a tu cuenta para que puedas seguir disfrutando de nuestras artesan√≠as.</p>
      </div>
    </div>`;
    const modalBg = document.getElementById('modal-bg');
    const modalContent = document.getElementById('modal-content');
    const modalClose = document.getElementById('modal-close');
    function openModal(content) {
      modalContent.innerHTML = `<button class='modal-close' id='modal-close'>&times;</button>` + content;
      modalBg.classList.add('active');
      setTimeout(() => {
        document.getElementById('modal-close').onclick = closeModal;
        
        // Enlaces del modal de login
        const reg = document.getElementById('modal-registro-link');
        if(reg) reg.onclick = (e) => { e.preventDefault(); openModal(registroForm); };
        const olv = document.getElementById('modal-olvido-link');
        if(olv) olv.onclick = (e) => { e.preventDefault(); openModal(olvidoForm); };
        
        // Enlaces del modal de registro
        const loginFromReg = document.getElementById('modal-login-link');
        if(loginFromReg) loginFromReg.onclick = (e) => { e.preventDefault(); openModal(loginForm); };
        
        // Enlaces del modal de olvido
        const loginFromOlv = document.getElementById('modal-login-link-olvido');
        if(loginFromOlv) loginFromOlv.onclick = (e) => { e.preventDefault(); openModal(loginForm); };
      }, 10);
    }
    function closeModal() {
      modalBg.classList.remove('active');
      setTimeout(() => { modalContent.innerHTML = ''; }, 300);
    }
    document.getElementById('btn-cuenta').onclick = (e) => { e.preventDefault(); openModal(loginForm); };
    // Cerrar modal al hacer click fuera del contenido
    modalBg.onclick = function(e) {
      if(e.target === modalBg) closeModal();
    };
    modalClose.onclick = closeModal;
    // CARRITO DESLIZABLE (funcionalidad avanzada)
    let carrito = JSON.parse(localStorage.getItem('carritoArtesanias')) || [];
    let productos = [
        { 
            id: 1, 
            nombre: 'Canasto Peque√±o', 
            precio: 35000, 
            imagen: './Canasto Peque√±o.jpg',
            icono: 'üß∫',
            descripcion: 'Canasto tradicional Zen√∫ elaborado en ca√±a flecha'
        },
        { 
            id: 2, 
            nombre: 'Mochila Escolar', 
            precio: 95000, 
            imagen: './Mochila Escolar.jpg',
            icono: 'üéí',
            descripcion: 'Mochila escolar tradicional con dise√±o resistente'
        },
        { 
            id: 3, 
            nombre: 'Sombrero Vueltiao', 
            precio: 85000, 
            imagen: './Sombrero Vueltiao.jpg',
            icono: 'üëí',
            descripcion: 'Sombrero vueltiao tradicional de la cultura Zen√∫'
        },
        { 
            id: 4, 
            nombre: 'Pulsera Tradicional', 
            precio: 45000, 
            imagen: './Pulsera Tradicional.jpg',
            icono: 'üíé',
            descripcion: 'Pulsera tradicional elaborada en ca√±a flecha'
        }
    ];

    // Elementos del carrito
    const cartOverlay = document.getElementById('cart-overlay');
    const cartSlide = document.getElementById('cart-slide');
    const cartContent = document.getElementById('cart-content');
    const cartTotal = document.getElementById('cart-total');
    const btnComprar = document.getElementById('btn-comprar');
    const btnContinuar = document.getElementById('btn-continuar');

    // Cargar carrito al iniciar la p√°gina
    cargarCarrito();

    function agregarCarrito(nombreProducto) {
        const usuarioLogueado = localStorage.getItem('usuarioLogueado');
        
        if (!usuarioLogueado) {
            openModal(loginForm);
            return;
        }

        // Buscar el producto en la lista
        const producto = productos.find(p => p.nombre === nombreProducto);
        if (!producto) return;

        // Verificar si ya existe en el carrito
        const itemExistente = carrito.find(item => item.id === producto.id);
        
        if (itemExistente) {
            itemExistente.cantidad += 1;
        } else {
            carrito.push({
                ...producto,
                cantidad: 1
            });
        }

        actualizarCarritoCompleto();
        guardarCarrito();
        mostrarNotificacion(`${producto.nombre} agregado al carrito`);
    }

    function actualizarCarrito() {
        // Actualizar badge
        const totalItems = carrito.reduce((sum, item) => sum + item.cantidad, 0);
        document.getElementById('carrito-badge').textContent = totalItems;

        // Actualizar contenido del carrito
        if (carrito.length === 0) {
            cartContent.innerHTML = `
                <div class="cart-empty">
                    <div class="cart-empty-icon">üõí</div>
                    <h4>Tu carrito est√° vac√≠o</h4>
                    <p>Descubre nuestras hermosas artesan√≠as Zen√∫ y agrega algunos productos para comenzar tu compra</p>
                    <button class="btn-explorar" onclick="cerrarCarrito()">Explorar Productos</button>
                </div>
            `;
            btnComprar.disabled = true;
            cartTotal.textContent = '$0';
            document.getElementById('cart-summary').style.display = 'none';
        } else {
            cartContent.innerHTML = carrito.map(item => {
                const subtotal = item.precio * item.cantidad;
                return `
                    <div class="cart-item" data-id="${item.id}">
                        <div class="cart-item-image">
                            <img src="${item.imagen}" alt="${item.nombre}" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="fallback-icon" style="display: none;">${item.icono}</div>
                        </div>
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.nombre}</div>
                            <div class="cart-item-description">${item.descripcion}</div>
                            <div class="cart-item-price-container">
                                <div class="cart-item-price">$${item.precio.toLocaleString()}</div>
                                <div class="cart-item-subtotal">Subtotal: $${subtotal.toLocaleString()}</div>
                            </div>
                            <div class="cart-item-quantity">
                                <span class="quantity-label">Cantidad:</span>
                                <button class="quantity-btn" onclick="cambiarCantidad(${item.id}, -1)">-</button>
                                <span class="quantity-display">${item.cantidad}</span>
                                <button class="quantity-btn" onclick="cambiarCantidad(${item.id}, 1)">+</button>
                            </div>
                        </div>
                        <button class="cart-item-remove" onclick="eliminarItem(${item.id})" title="Eliminar del carrito">üóëÔ∏è</button>
                    </div>
                `;
            }).join('');

            // Calcular totales
            const subtotal = carrito.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
            const shipping = subtotal > 100000 ? 0 : 15000; // Env√≠o gratis sobre $100k
            const total = subtotal + shipping;

            // Actualizar resumen
            document.getElementById('cart-subtotal').textContent = `$${subtotal.toLocaleString()}`;
            document.getElementById('cart-shipping').textContent = shipping === 0 ? 'Gratis' : `$${shipping.toLocaleString()}`;
            document.getElementById('cart-total-summary').textContent = `$${total.toLocaleString()}`;
            document.getElementById('cart-total').textContent = `$${total.toLocaleString()}`;
            
            // Mostrar resumen
            document.getElementById('cart-summary').style.display = 'block';
            btnComprar.disabled = false;
        }
    }

    function cambiarCantidad(id, cambio) {
        const item = carrito.find(item => item.id === id);
        if (!item) return;

        item.cantidad += cambio;
        
        if (item.cantidad <= 0) {
            eliminarItem(id);
        } else {
            actualizarCarritoCompleto();
            guardarCarrito();
        }
    }

    function eliminarItem(id) {
        carrito = carrito.filter(item => item.id !== id);
        actualizarCarritoCompleto();
        guardarCarrito();
    }

    function abrirCarrito() {
        const usuarioLogueado = localStorage.getItem('usuarioLogueado');
        
        if (!usuarioLogueado) {
            openModal(loginForm);
            return;
        }

        cartOverlay.classList.add('active');
        cartSlide.classList.add('active');
        actualizarCarrito();
    }

    function cerrarCarrito() {
        cartOverlay.classList.remove('active');
        cartSlide.classList.remove('active');
    }

    function comprar() {
        if (carrito.length === 0) return;

        const subtotal = carrito.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
        const shipping = subtotal > 100000 ? 0 : 15000;
        const total = subtotal + shipping;
        
        const resumen = carrito.map(item => 
            `${item.nombre} x${item.cantidad} - $${(item.precio * item.cantidad).toLocaleString()}`
        ).join('\n');

        const confirmacion = `¬øConfirmar compra?\n\n${resumen}\n\nSubtotal: $${subtotal.toLocaleString()}\nEnv√≠o: ${shipping === 0 ? 'Gratis' : '$' + shipping.toLocaleString()}\n\nTOTAL: $${total.toLocaleString()}`;

        if (confirm(confirmacion)) {
            alert('¬°Compra realizada con √©xito! Te contactaremos pronto para coordinar la entrega.');
            carrito = [];
            actualizarCarritoCompleto();
            guardarCarrito();
            cerrarCarrito();
        }
    }

    function mostrarNotificacion(mensaje) {
        // Crear notificaci√≥n temporal
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--naranja);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10000;
            font-weight: 600;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        `;
        notification.textContent = mensaje;
        document.body.appendChild(notification);

        // Animar entrada
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 10);

        // Remover despu√©s de 3 segundos
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 3000);
    }

    // Event listeners del carrito
    document.getElementById('btn-carrito').onclick = abrirCarrito;
    document.getElementById('cart-close').onclick = cerrarCarrito;
    document.getElementById('btn-comprar').onclick = comprar;
    document.getElementById('btn-continuar').onclick = cerrarCarrito;
    cartOverlay.onclick = cerrarCarrito;
    
    // FUNCIONES DE AUTENTICACI√ìN
    function iniciarSesion() {
        const usuario = document.getElementById('login-usuario').value;
        const contrase√±a = document.getElementById('login-contrase√±a').value;
        
        if (!usuario || !contrase√±a) {
            alert('Por favor completa todos los campos');
            return;
        }
        
        // Simulaci√≥n de login (aqu√≠ ir√≠a la l√≥gica real de autenticaci√≥n)
        if (usuario === 'admin' && contrase√±a === 'admin') {
            // Guardar estado de login en localStorage
            localStorage.setItem('usuarioLogueado', 'true');
            localStorage.setItem('usuario', usuario);
            alert('¬°Bienvenido! Redirigiendo al dashboard...');
            closeModal();
            window.location.href = './dashboard/usuario.html';
        } else {
            alert('Usuario o contrase√±a incorrectos');
        }
    }
    
    function registrarUsuario() {
        const usuario = document.getElementById('reg-usuario').value;
        const contrase√±a = document.getElementById('reg-contrase√±a').value;
        const email = document.getElementById('reg-email').value;
        const telefono = document.getElementById('reg-telefono').value;
        
        if (!usuario || !contrase√±a || !email || !telefono) {
            alert('Por favor completa todos los campos');
            return;
        }
        
        // Validaci√≥n b√°sica de email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            alert('Por favor ingresa un email v√°lido');
            return;
        }
        
        // Simulaci√≥n de registro (aqu√≠ ir√≠a la l√≥gica real de registro)
        // Guardar estado de login en localStorage
        localStorage.setItem('usuarioLogueado', 'true');
        localStorage.setItem('usuario', usuario);
        alert('¬°Registro exitoso! Ya est√°s logueado');
        closeModal();
    }
    
    function recuperarContrase√±a() {
        const email = document.getElementById('olvido-email').value;
        
        if (!email) {
            alert('Por favor ingresa tu email');
            return;
        }
        
        // Validaci√≥n b√°sica de email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            alert('Por favor ingresa un email v√°lido');
            return;
        }
        
        // Simulaci√≥n de recuperaci√≥n (aqu√≠ ir√≠a la l√≥gica real de recuperaci√≥n)
        alert('Se ha enviado un enlace de recuperaci√≥n a tu email');
        openModal(loginForm);
    }
    </script>
</body>
</html>
